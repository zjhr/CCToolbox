<div align="center">
  <img src="docs/logo.png" alt="CC-TOOL Logo" width="120" />

  # CC-TOOL

  **ClaudeCode 增强工作助手 - 会话管理 & 多渠道切换工具**

  [![npm version](https://img.shields.io/npm/v/cc-tool.svg)](https://www.npmjs.com/package/cc-tool)
  [![License](https://img.shields.io/badge/license-MIT-green.svg)](LICENSE)

  <img src="docs/cc-tool.png" alt="CC-TOOL Screenshot" width="90%" />
</div>

## 安装

### 从 npm 安装（推荐）

```bash
npm install -g cc-tool
```

### 从源码安装

```bash
# 克隆项目
git clone https://github.com/CooperJiang/cc-tool.git
cd cc-tool

# 安装依赖
npm install

# 全局链接
npm link
```

## 快速开始

安装完成后，您可以通过以下命令使用 CC-TOOL：

### 📟 命令行模式
```bash
cct
```
启动交互式命令行界面，通过菜单选择操作完成会话管理、渠道切换等任务。

### 🌐 Web UI 模式（推荐）
```bash
cct ui
```
启动可视化 Web 界面，浏览器自动打开 `http://localhost:9999`，提供更直观的操作体验：
- 可视化管理所有项目和会话
- 拖拽排序渠道和项目
- 全局搜索对话内容（快捷键 `⌘/Ctrl + K`）
- 实时查看 API 请求日志和 Token 消耗
- 动态切换渠道无需重启

### 🔧 故障修复
```bash
cct reset
```
如果遇到动态渠道异常或配置问题，使用此命令恢复默认配置。

---

## 简介

CC-TOOL 是一个强大的 ClaudeCode 增强工具，为 AI 辅助开发提供全方位的会话管理和渠道切换解决方案。

**核心优势**：

🎯 **智能会话管理** - 自动识别 ClaudeCode 项目，动态管理所有历史会话，支持自定义命名让会话一目了然，随时通过全局搜索快速定位任意对话内容

🔀 **无缝渠道切换** - 动态管理多个 API 渠道，一键切换无需重启终端或中断工作流，让你在不同 API 服务商之间自由选择，成本优化与稳定性兼得

⚡ **上下文复用** - Fork 对话功能让你可以基于现有对话创建分支，完整保留上下文同时探索不同方向，避免重复描述问题背景

📊 **实时监控** - 可视化展示每次 API 请求的 Token 消耗（输入/输出/缓存），清晰掌握成本和性能，帮助优化提示词和对话策略

🌐 **Web 可视化界面** - 除了传统 CLI 模式，还提供现代化的 Web UI，让会话管理、渠道切换、全局搜索等操作更直观高效

### 核心特性

#### 🎯 会话管理
- 📋 **项目与会话管理**：列出所有项目和会话，支持拖拽排序
- 🏷️ **会话别名**：为会话设置易记的名称
- 🔎 **全局搜索**：快捷键 `⌘/Ctrl + K` 跨项目搜索会话内容
- 🌿 **Fork 会话**：创建会话分支，保留历史版本
- 🗑️ **会话删除**：清理不需要的会话

#### 🔀 多渠道管理
- 🌐 **动态切换渠道**：无需重启，一键切换不同 API 渠道
- ⚡ **实时代理**：本地代理服务，透明切换 API 渠道
- 🎨 **渠道可视化管理**：添加、编辑、删除渠道，支持拖拽排序
- 📦 **渠道折叠**：卡片式展示，支持折叠节省空间
- 🔒 **安全管理**：API Key 脱敏显示，防止泄露

#### 📊 实时监控
- 📡 **实时日志**：WebSocket 推送，实时查看 API 请求详情
- 🎯 **Token 统计**：显示请求/回复/缓存写入/缓存命中 Token 数
- 🏷️ **行为日志**：渠道切换、会话启动等操作实时提示
- 📈 **连接状态**：WebSocket 连接状态实时显示

#### 🎨 用户体验
- 🎭 **面板控制**：自定义显示/隐藏渠道列表和日志面板
- 💾 **状态持久化**：所有设置自动保存，刷新不丢失
- 🌊 **流畅动画**：平滑的过渡动画，提升视觉体验
- 📱 **响应式设计**：适配不同屏幕尺寸

## 功能详解

### 📋 会话管理

#### 查看和管理会话

- **项目列表**：卡片式展示所有项目，显示会话数量
- **会话列表**：点击项目查看该项目下的所有会话
- **会话别名**：点击会话卡片的编辑按钮设置别名
- **启动会话**：点击"使用对话"直接在 ClaudeCode 中打开
- **删除会话**：清理不需要的会话

#### 全局搜索

快捷键：`⌘ + K`（Mac）或 `Ctrl + K`（Windows/Linux）

- 搜索所有项目的会话内容
- 支持搜索消息、别名、Session ID
- 高亮显示匹配的关键词
- 显示匹配次数和上下文
- 一键启动搜索到的会话

#### Fork 会话

创建会话的副本，保留原会话不变：

1. 在会话列表中点击 Fork 按钮
2. 选择 Fork 模式（继续原会话 / Fork 新分支）
3. 新会话会继承原会话的所有历史消息

> 💡 **推荐**：99% 的情况选择"继续原会话"，仅在需要保留历史版本时使用 Fork

### 🔀 多渠道管理

#### 添加 API 渠道

1. 点击右上角"添加渠道"按钮
2. 填写渠道信息：
   - **渠道名称**：如 "官方API"、"中转平台A"
   - **Base URL**：API 端点地址
   - **API Key**：你的 API 密钥
   - **官网地址**（可选）：渠道官网链接
3. 点击保存

#### 动态切换渠道

**前提条件**：开启"动态切换"功能

1. 点击顶部工具栏的"动态切换"开关
2. 在渠道列表中点击"切换"按钮
3. ClaudeCode 会自动使用新渠道，无需重启

> ⚠️ **注意**：动态切换期间请勿关闭 ClaudeCode 窗口

#### 管理渠道

- **编辑渠道**：点击"编辑"按钮修改渠道信息
- **删除渠道**：点击"删除"按钮移除渠道（使用中的渠道不能删除）
- **拖拽排序**：直接拖动卡片调整顺序，自动保存
- **折叠卡片**：点击卡片左侧箭头折叠/展开，节省空间
- **访问官网**：点击"前往官网"快速跳转到渠道官网

## 常见问题

### Q1: 动态切换不生效？

**A**: 确保：
1. 已开启"动态切换"开关
2. ClaudeCode 进程窗口未关闭
3. 配置的 API Key 和 Base URL 正确

### Q2: 实时日志面板不显示？

**A**: 实时日志需要先开启"动态切换"功能，开启后会自动显示。

### Q3: 渠道配置丢失？

**A**: 渠道配置保存在 `~/.claude/cc-tool/channels.json`，不会丢失。如果遇到问题，检查该文件是否存在和格式是否正确。

### Q4: WebSocket 连接失败？

**A**:
1. 检查端口 10099 是否被占用
2. 重启 CC-TOOL 服务
3. 查看控制台错误信息

### Q5: 如何备份配置？

**A**: 直接复制 `~/.claude/cc-tool/` 整个目录即可。

## 版本历史

### v2.0.0（最新）

**新增功能**：
- ✨ API 渠道管理系统
- ⚡ 动态切换渠道（无需重启）
- 📡 实时日志监控（WebSocket）
- 🔍 全局搜索（⌘/Ctrl + K）
- 🎨 面板可见性控制
- 📱 渠道拖拽排序和折叠
- 💾 配置持久化
- 🌊 流畅动画效果

**优化改进**：
- 🎯 全新 UI 设计
- 📊 实时 Token 统计
- 🔒 API Key 脱敏显示
- ⚙️ 性能优化（API 轮询从 5s 改为 30s）
- 🐛 修复 WebSocket 重复连接问题
- 🎨 优化加载状态和错误处理

查看 [CHANGELOG.md](docs/CHANGELOG.md) 了解详细更新记录。

## Star History

如果你喜欢这个项目，请给它一个 Star ⭐！

[![Star History Chart](https://api.star-history.com/svg?repos=CooperJiang/cc-tool&type=Date)](https://star-history.com/#CooperJiang/cc-tool&Date)

## 贡献

欢迎提交 Issue 和 Pull Request！

1. Fork 本仓库
2. 创建特性分支 (`git checkout -b feature/AmazingFeature`)
3. 提交更改 (`git commit -m 'Add some AmazingFeature'`)
4. 推送到分支 (`git push origin feature/AmazingFeature`)
5. 开启 Pull Request

## 许可

MIT License

---

**Made with ❤️ for ClaudeCode users**
